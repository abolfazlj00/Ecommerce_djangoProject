{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kama-{% block title %}{% endblock %}</title>

    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css"/>

    <!-- font awesome cdn link  -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

    <!-- custom css file link  -->
    <link rel="stylesheet" href="{% static 'store/css/main.css' %}">
    {% block loadCss %}{% endblock %}
</head>
<body>


<header>

    <a href="{% url 'store:home' %}" class="logo" id="home_logo"><b id="k">K</b>ama<span>.</span></a>

    <form action="">
        <input type="search" id="search-bar">
        <label for="search-bar" class="fas fa-search"></label>
    </form>

    <div class="icons">
        <div id="menu-bar" class="fas fa-bars"></div>
        <div id="theme-toggler" class="fas fa-moon"></div>
        <a href="#" class="fas fa-heart"></a>
        <a href="{% url 'order:cart' %}" class="fas fa-shopping-cart"><span id="total_cart">0</span></a>
        {% if user.is_authenticated %}
            <a href="{% url 'account:logout' %}" id="logOut_link" class="fas fa-sign-out-alt"></a>
        {% else %}
            <a href="{% url 'account:login' %}" id="login_link" class="fas fa-user"></a>
        {% endif %}

    </div>

</header>

<!-- header section ends -->

<!-- navbar section  -->

<nav class="navbar">

    <div class="user">
        {% if user.is_authenticated %}
            <img src="/media/userImage/avatar.png" alt="avatar">
            <h3>{{ user.first_name }} {{ user.last_name }}</h3>
        {% else %}
            <img src="/media/userImage/avatar.png" alt="avatar">
            <h3>Anonymous User</h3>
        {% endif %}

    </div>

    <div class="links">
        <a href="{% url 'store:home' %}">Home</a>
        <a href="{% url 'account:profile' %}">Profile</a>
        <a href="#">Categories</a>
        <a href="#">Deal</a>
        <a href="#">Review</a>
    </div>

    <div id="close" class="fas fa-times"></div>

</nav>

{% block sidebar %}{% endblock %}
{% block content %}{% endblock %}

<div class="container-fluid footer">
    <p class="text-center mb-0">
        Copyright @2021 | Designed With by abolfazlj00
    </p>
</div>
<script src="{% static 'store/js/base.js' %}"></script>
<script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
<script type="text/javascript">
    var login_user = '{{ request.user }}'
    if (!localStorage.getItem(login_user)) {
        if (localStorage.getItem('AnonymousUser')) {
            localStorage.setItem(login_user, localStorage.getItem('AnonymousUser'))
            localStorage.removeItem('AnonymousUser')
        }
    }
    if (login_user !== 'AnonymousUser'){
        if (localStorage.getItem('AnonymousUser')) {
            localStorage.removeItem('AnonymousUser')
        }
    }
    function getToken(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }

    const csrf__token = getToken('csrftoken');
</script>
<script>
    if (localStorage.getItem(login_user)) {
        document.getElementById('total_cart').innerHTML = Object.keys(JSON.parse(localStorage.getItem(login_user))).length.toString()
    } else {
        document.getElementById('total_cart').innerHTML = 0
    }
</script>
{% block loadJs %}
{% endblock %}
</body>
</html>
